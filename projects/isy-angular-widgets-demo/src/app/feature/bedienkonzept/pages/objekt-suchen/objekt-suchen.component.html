<p-panel header="Objekt suchen" [toggleable]="true" iconPos="start">
  <div class="grid m-0">
    <div class="col-1 text-right align-self-center">
      <label class="" for="ID">ID</label>
    </div>
    <div class="col">
      <input id="ID" type="text" pInputText [(ngModel)]="person.id" class="w-full ng-invalid ng-dirt"/>
    </div>
    <div class="col-1"></div>
    <div class="col"></div>
    <div class="col-1"></div>
    <div class="col"></div>
  </div>

  <div class="grid m-0">
    <div class="col-1 text-right align-self-center">
      <label for="Nachname">Nachname</label>
    </div>
    <div class="col">
      <input id="Nachname" class="w-full" type="text" pInputText [(ngModel)]="person.personalien.nachname">
    </div>
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Geburtsname">Geburtsname</label>
    </div>
    <div class="col">
      <input id="Geburtsname" class="w-full" type="text" pInputText [(ngModel)]="person.personalien.geburtsname">
    </div>
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Geburtsname">Geburtsort</label>
    </div>
    <div class="col">
      <input id="Geburtsort" class="w-full" type="text" pInputText [(ngModel)]="person.personalien.geburtsort">
    </div>
  </div>

  <div class="grid m-0">
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Vorname">Vorname </label>
    </div>
    <div class="col">
      <input id="Vorname" class="w-full" type="text" pInputText [(ngModel)]="person.personalien.vorname">
    </div>
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Geschlecht">Geschlecht </label>
    </div>
    <div class="col">
      <input id="Geschlecht" class="w-full" type="text" pInputText [(ngModel)]="person.personalien.geschlecht">
    </div>
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Geburtsdatum">Geburtsdatum </label>
    </div>
    <div class="col">
      <p-calendar id="Geburtsdatum"
                  dateFormat="dd.mm.yy"
                  [(ngModel)]="person.personalien.geburtsdatum"
                  [showIcon]="true"
      >
      </p-calendar>
    </div>
  </div>

  <div class="grid m-0">
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Staatsangehörigkeit">Staatsangehörigkeit</label>
    </div>
    <div class="col-3">
      <p-dropdown id="Staatsangehörigkeit"
                  placeholder="Land wählen"
                  [options]="laender"
                  [(ngModel)]="person.personalien.staatsangehoerigkeit"
                  [showClear]="true"
      >
        <ng-template pTemplate="selectedItem">
          <div class="country-item country-item-value" *ngIf="person.personalien.staatsangehoerigkeit">
            <div>{{person.personalien.staatsangehoerigkeit}}</div>
          </div>
        </ng-template>
        <ng-template let-land pTemplate="item">
          <div class="country-item">
            <div>{{land}}</div>
          </div>
        </ng-template>
      </p-dropdown>
    </div>
    <div class="col-1 text-right align-self-center"></div>
    <div class="col"></div>
    <div class="col-1 text-right align-self-center"></div>
    <div class="col"></div>
  </div>

  <div class="flex justify-content-end p-2">
    <p-button [label]="'Suchen'"
              class="mr-1"
              [iconPos]="'left'"
              [icon]="'pi pi-search'"
              (onClick)="findPerson()"
    >
    </p-button>
    <p-button [label]="'Suche leeren'"
              [iconPos]="'left'"
              [disabled]="!enableClearSearch()"
              (onClick)="clearSearch()"
    >
    </p-button>
  </div>
</p-panel>

<demo-result-list *ngIf="personen$ | async as personen"
                  [personen]="personen"
                  [selectedObject]="selectedPerson"
                  (edit)="editSelectedPerson($event)"
                  (create)="openAddNewObjectDialog()"
                  [loading]="tbLoadingStatus"
>
</demo-result-list>

<p-dialog [header]="'Ausgewähltes Objekt bearbeiten'"
          [(visible)]="openEditForm"
          [modal]="modal"
          [style]="{
            width: width + 'vw'
          }"
>
  <div [formGroup]="editForm" *ngIf="selectedPerson && editForm">
    <div class="grid m-0">
      <div class="col-1 text-right align-self-center">
        <label for="editID">ID</label>
      </div>
      <div class="col">
        <input id="editID" class="w-full" type="text" pInputText [formControlName]="'editID'"/>
      </div>
      <div class="col-1"></div>
      <div class="col"></div>
      <div class="col-1"></div>
      <div class="col"></div>
    </div>
    <div class="grid m-0">
      <div class="col-1 text-right align-self-center">
        <label for="editNachname">Nachname</label>
      </div>
      <div class="col">
        <input id="editNachname" class="w-full" type="text" pInputText [formControlName]="'editNachname'">
      </div>
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editGeburtsname">Geburtsname</label>
      </div>
      <div class="col">
        <input id="editGeburtsname" class="w-full" type="text" pInputText [formControlName]="'editGeburtsname'">
      </div>
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editGeburtsname">Geburtsort</label>
      </div>
      <div class="col">
        <input id="editGeburtsort" class="w-full" type="text" pInputText [formControlName]="'editGeburtsort'">
      </div>
    </div>
    <div class="grid m-0">
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editVorname">Vorname </label>
      </div>
      <div class="col">
        <input id="editVorname" class="w-full" type="text" pInputText [formControlName]="'editVorname'">
      </div>
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editGeschlecht">Geschlecht </label>
      </div>
      <div class="col">
        <input id="editGeschlecht" class="w-full" type="text" pInputText [formControlName]="'editGeschlecht'">
      </div>
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editGeburtsdatum">Geburtsdatum </label>
      </div>
      <div class="col">
        <p-calendar
          id="editGeburtsdatum"
          dateFormat="dd.mm.yy"
          [formControlName]="'editGeburtsdatum'"
          [showIcon]="true"
        >
        </p-calendar>
      </div>
    </div>
    <div class="grid m-0">
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editStaatsangehörigkeit">Staatsangehörigkeit</label>
      </div>
      <div class="col-3">
        <p-dropdown id="editStaatsangehörigkeit"
                    placeholder="Land wählen"
                    [options]="laender"
                    [showClear]="true"
                    [formControlName]="'editStaatsangehoerigkeit'"
        >
          <ng-template pTemplate="selectedItem">
            <div class="country-item country-item-value" *ngIf="selectedPerson!.personalien.staatsangehoerigkeit">
              <div>{{selectedPerson!.personalien.staatsangehoerigkeit}}</div>
            </div>
          </ng-template>
          <ng-template let-land pTemplate="item">
            <div class="country-item">
              <div>{{land}}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
    </div>
    <div class="flex justify-content-end flex-wrap card-container pt-2">
      <p-button class="flex align-items-center justify-content-center mr-1"
                label="Speichern"
                (onClick)="saveChanges()"
                [disabled]="!editForm.valid || !allowSave"
      >
      </p-button>
      <p-button class="flex align-items-center justify-content-center mr-1"
                label="Schließen"
                (onClick)="displayEditDialog()"
      >
      </p-button>
    </div>
  </div>
</p-dialog>

<isy-wizard *ngIf="openWizard"
            [width]="50"
            [height]="30"
            [headerTitle]="'Anlegen eines komplexen Objektes'"
            [allowNext]="isFormValid"
            [(isVisible)]="openWizard"
            (isVisibleChange)="onWizardClose($event)"
            (stepperIndexChange)="getWizardIndex($event)"
            (savingChange)="getSavedStatus($event)"
            [isSaved]="savedSuccessfully"
            [closable]="displayX"
>
  <!-- The wizard is generic, you can input any element. For example:-->
  <!-- 1. A simple form -->
  <div *isyWizardDirective="'ID Eintrag'">
    <div [formGroup]="idForm">
      <div class="formgrid grid">
        <div class="col align-content-end">
          <div class="col">
            <div class="field">
              <label id="idLabel" for="personId">ID*</label>
              <input id="personId" class="w-full" type="text" pInputText [formControlName]="'id'"/>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 2. A custom component representing your form -->
  <form *isyWizardDirective="'Persönliche Informationen'">
    <demo-persoenliche-informationen [form]="persoenlicheInformationenForm">
    </demo-persoenliche-informationen>
  </form>

  <!-- 3. A complex form -->
  <div *isyWizardDirective="'Geburtsinformationen'">
    <div class="formgrid grid">
      <div class="col align-content-end">
        <div [formGroup]="geburtsInformationenForm">
          <div class="col">
            <div class="field">
              <label id="geburtsnameLabel" class="align-content-end" for="geburtname">Geburtsname*</label>
              <input id="geburtname" class="w-full" type="text" pInputText [formControlName]="'geburtsname'">
            </div>
            <div class="field">
              <label id="geburtsortLabel" class="align-content-end" for="geburtort">Geburtsort*</label>
              <input id="geburtort" class="w-full" type="text" pInputText [formControlName]="'geburtsort'">
            </div>
          </div>

          <div class="col">
            <div class="field">
              <label id="staatsangehoerigkeitLabel" class="align-content-end" for="staatangehoerigkeit">Staatsangehörigkeit*</label>
              <p-dropdown id="staatangehoerigkeit"
                          placeholder="Land wählen"
                          optionValue="name"
                          optionLabel="name"
                          [showClear]="true"
                          [options]="laenderMap"
                          [formControlName]="'staatsangehoerigkeit'"
              >
                <ng-template let-land pTemplate="item">
                  <div class="country-item">
                    <div>{{land.name}}</div>
                  </div>
                </ng-template>
              </p-dropdown>
            </div>

            <div class="field">
              <label id="geburtsdatumLabel" class="align-content-end" for="geburtdatum">Geburtsdatum*</label>
              <p-calendar
                id="geburtdatum"
                dateFormat="dd.mm.yy"
                [formControlName]="'geburtsdatum'"
                [showIcon]="true">
              </p-calendar>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</isy-wizard>

<p-toast
  id="notificationToast"
  position="top-right"
>
</p-toast>
