<p-panel
  iconPos="start"
  [header]="'isyAngularWidgetsDemo.displayObject.masterDataHeader' | translate"
  [toggleable]="true"
>
  <div class="grid m-0">
    <div class="col-1 text-right align-self-center">
      <label for="basis-nachname">
        {{ 'isyAngularWidgetsDemo.labels.nachname' | translate }}
      </label>
    </div>
    <div class="col">
      <input
        id="basis-nachname"
        class="w-full"
        type="text"
        pInputText
        disabled
        [(ngModel)]="person.personalien.nachname"
      />
    </div>
    <div class="col-1 text-right align-self-center">
      <label for="basis-vorname">
        {{ 'isyAngularWidgetsDemo.labels.vorname' | translate }}
      </label>
    </div>
    <div class="col">
      <input
        id="basis-vorname"
        class="w-full"
        type="text"
        pInputText
        disabled
        [(ngModel)]="person.personalien.vorname"
      />
    </div>
    <div class="col-1 text-right align-self-center">
      <label for="basis-geburtsdatum">
        {{ 'isyAngularWidgetsDemo.labels.geburtsdatum' | translate }}
      </label>
    </div>
    <div class="col">
      <input
        id="basis-geburtsdatum"
        class="w-full"
        type="text"
        pInputText
        disabled
        [(ngModel)]="person.personalien.geburtsdatum"
      />
    </div>
  </div>
</p-panel>

<p-tabView id="tab-view">
  <p-tabPanel id="panel-personalien" [header]="'isyAngularWidgetsDemo.displayObject.tabPersonalData' | translate">
    <form [formGroup]="personalInfoForm">
      <div class="grid m-0">
        <div class="col-1 text-right align-self-center">
          <label for="last-name">
            {{ 'isyAngularWidgetsDemo.labels.nachname' | translate }}
          </label>
        </div>
        <div class="col">
          <input id="last-name" formControlName="lastName" type="text" pInputText isyInputChar />
          <small
            class="p-error block"
            *ngIf="personalInfoForm.controls['lastName'].invalid && personalInfoForm.controls['lastName'].touched"
          >
            {{ 'isyAngularWidgetsDemo.messages.requiredMessage' | translate }}
          </small>
        </div>
        <div class="col-1 text-right align-self-center">
          <label class="align-content-end" for="birth-name">
            {{ 'isyAngularWidgetsDemo.labels.geburtsname' | translate }}
          </label>
        </div>
        <div class="col">
          <input id="birth-name" formControlName="birthName" type="text" pInputText isyInputChar />
        </div>
        <div class="col-1 text-right align-self-center">
          <label class="align-content-end" for="birth-place">
            {{ 'isyAngularWidgetsDemo.labels.geburtsort' | translate }}
          </label>
        </div>
        <div class="col">
          <input id="birth-place" formControlName="birthplace" class="w-full" type="text" pInputText />
        </div>
      </div>
      <div class="grid m-0">
        <div class="col-1 text-right align-self-center">
          <label for="first-name">
            {{ 'isyAngularWidgetsDemo.labels.vorname' | translate }}
          </label>
        </div>
        <div class="col">
          <input
            id="first-name"
            formControlName="firstName"
            class="w-full"
            required
            minlength="2"
            type="text"
            pInputText
          />
          <small class="p-error block" *ngIf="personalInfoForm.controls['firstName'].invalid">
            {{ 'isyAngularWidgetsDemo.messages.requiredMessage' | translate }}
          </small>
        </div>
        <div class="col-1 text-right align-self-center">
          <label class="align-content-end" for="gender">
            {{ 'isyAngularWidgetsDemo.labels.geschlecht' | translate }}
          </label>
        </div>
        <div class="col">
          <p-dropdown
            inputId="gender"
            formControlName="gender"
            [filter]="true"
            filterBy="name"
            [options]="[
              'isyAngularWidgetsDemo.labels.optionMale' | translate,
              'isyAngularWidgetsDemo.labels.optionFemale' | translate,
              'isyAngularWidgetsDemo.labels.optionDivers' | translate
            ]"
          ></p-dropdown>
        </div>
        <div class="col-1 text-right align-self-center">
          <label class="align-content-end" for="birth-date">
            {{ 'isyAngularWidgetsDemo.labels.geburtsdatum' | translate }}
          </label>
        </div>
        <div class="col">
          <p-calendar inputId="birth-date" dateFormat="dd.mm.yy" formControlName="birthDate" [showIcon]="true">
          </p-calendar>
        </div>
      </div>
      <div class="grid m-0">
        <div class="col-1 text-right align-self-center">
          <label for="nationality">
            {{ 'isyAngularWidgetsDemo.labels.staatsangehoerigkeit' | translate }}
          </label>
        </div>
        <div class="col">
          <input id="nationality" formControlName="nationality" class="w-full" type="text" pInputText />
        </div>
        <div class="col-1 text-right align-self-center">
          <label class="align-content-end" for="phone-number">
            {{ 'isyAngularWidgetsDemo.labels.telefonnummer' | translate }}
          </label>
        </div>
        <div class="col">
          <p-inputMask
            inputId="phone-number"
            formControlName="phoneNumber"
            type="text"
            [style]=""
            mask="+99 9999 / 9999999"
          >
          </p-inputMask>
        </div>
        <div class="col-1 text-right align-self-center">
          <label class="align-content-end" for="date-of-entry">
            {{ 'isyAngularWidgetsDemo.labels.einreisedatum' | translate }}
          </label>
        </div>
        <div class="col">
          <isy-incomplete-date inputId="date-of-entry" formControlName="dateOfEntry" [dateInPastConstraint]="true">
          </isy-incomplete-date>
          <small
            class="p-error block"
            *ngIf="
              personalInfoForm.controls['dateOfEntry'].invalid &&
              (personalInfoForm.controls['dateOfEntry'].touched || personalInfoForm.controls['dateOfEntry'].dirty)
            "
          >
            {{ 'isyAngularWidgetsDemo.messages.inputUnspecifiedError' | translate }}
          </small>
        </div>
      </div>
      <div class="grid m-0">
        <div class="col-1 text-right align-self-center">
          <label for="date-of-departure">
            {{ 'isyAngularWidgetsDemo.labels.abreisedatum' | translate }}
          </label>
        </div>
        <div class="col">
          <input id="date-of-departure" formControlName="dateOfDeparture" class="w-full" type="text" pInputText />
        </div>
        <div class="col-1 text-right align-self-center">
          <label class="align-content-end" for="passport-expiration-date">
            {{ 'isyAngularWidgetsDemo.labels.ablaufdatumReisepass' | translate }}
          </label>
        </div>
        <div class="col">
          <p-calendar
            inputId="passport-expiration-date"
            dateFormat="dd.mm.yy"
            formControlName="passportExpirationDate"
            [showIcon]="true"
          >
          </p-calendar>
        </div>
        <div class="col-1 text-right align-self-center">
          <label for="credit-card-number">
            {{ 'isyAngularWidgetsDemo.labels.kreditkartennummer' | translate }}
          </label>
        </div>
        <div class="col">
          <input id="credit-card-number" formControlName="creditCardNumber" class="w-full" type="text" pInputText />
        </div>
      </div>
      <div class="grid m-0">
        <div class="col-1 text-right align-self-center">
          <label for="credit-card-expiration-date">
            {{ 'isyAngularWidgetsDemo.labels.ablaufdatumKreditkarte' | translate }}
          </label>
        </div>
        <div class="col-3">
          <input
            id="credit-card-expiration-date"
            formControlName="creditCardExpirationDate"
            class="w-full"
            type="text"
            pInputText
          />
        </div>
        <div class="col-1 text-right align-self-center">
          <label for="identity-document">
            {{ 'isyAngularWidgetsDemo.labels.identityDocument' | translate }}
          </label>
        </div>
        <div class="col-3">
          <p-fileUpload
            id="identity-document"
            formControlName="identityDocument"
            ngDefaultControl
            [name]="'myfile'"
            [accept]="'image/*,.pdf,.txt'"
            [auto]="true"
            [maxFileSize]="1000000"
            [customUpload]="true"
            (uploadHandler)="uploadFile($event)"
          >
          </p-fileUpload>
        </div>
      </div>
      <div class="grid m-0 mt-5" *isyPermitted="'secretFieldsInputSwitch'">
        <div class="col">
          <div class="field field-checkbox">
            <p-inputSwitch inputId="show-secret-fields" (onChange)="showSecretFields = $event.checked"></p-inputSwitch>
            <label for="show-secret-fields">
              {{ 'isyAngularWidgetsDemo.actions.showSecretFields' | translate }}
            </label>
          </div>
        </div>
      </div>
      <div id="div-show-secret-fields" *ngIf="showSecretFields">
        <div class="grid m-0">
          <div class="col-1 text-right align-self-center">
            <label for="id-required">
              {{ 'isyAngularWidgetsDemo.labels.ausweispflichtig' | translate }}
            </label>
          </div>
          <div class="col-1">
            <p-checkbox id="id-required" formControlName="idRequired" [binary]="true"> </p-checkbox>
          </div>
          <div class="col-1 text-right align-self-center">
            <label class="align-content-end" for="security-level">
              {{ 'isyAngularWidgetsDemo.labels.sicherheitsstufe' | translate }}
            </label>
          </div>
          <div class="col-5">
            <p-inputNumber id="security-level" formControlName="securityLevel" [showButtons]="true" [min]="0" [max]="9">
            </p-inputNumber>
          </div>
          <div class="col-6"></div>
        </div>
        <div class="grid m-0">
          <div class="col-1 text-right align-self-center">
            <label for="intelligence-notes">
              {{ 'isyAngularWidgetsDemo.labels.geheimdienstnotizen' | translate }}
            </label>
          </div>
          <div class="col-5">
            <textarea
              pInputTextarea
              id="intelligence-notes"
              formControlName="intelligenceNotes"
              class="w-full"
              [rows]="5"
            >
            </textarea>
            <small class="p-error block" *ngIf="personalInfoForm.controls['intelligenceNotes'].invalid">
              {{ 'isyAngularWidgetsDemo.messages.maxLengthError' | translate: {numChars: intelligenceNotesMaxLength} }}
            </small>
          </div>
          <div class="col-6"></div>
        </div>
      </div>
    </form>

    <div class="justify-content-center flex mt-3">
      <button
        pButton
        *ngIf="personalInfoForm.disabled"
        id="button-edit"
        icon="pi pi-user-edit"
        iconPos="left"
        [label]="'isyAngularWidgetsDemo.actions.edit' | translate"
        (click)="personalInfoForm.enable()"
      ></button>
      <div id="div-save-cancel" *ngIf="!personalInfoForm.disabled" class="p-buttonset">
        <button
          pButton
          id="button-save"
          icon="pi pi-save"
          iconPos="left"
          [disabled]="!personalInfoForm.valid"
          [label]="'isyAngularWidgetsDemo.actions.save' | translate"
          (click)="savePersonalien()"
        ></button>
        <button
          pButton
          id="button-cancel"
          icon="pi pi-times"
          class="p-button-outlined"
          iconPos="left"
          [label]="'isyAngularWidgetsDemo.actions.cancel' | translate"
          (click)="this.personalInfoForm.disable()"
        ></button>
      </div>
    </div>
  </p-tabPanel>

  <p-tabPanel id="panel-sachverhalte" [header]="'isyAngularWidgetsDemo.displayObject.tabFacts' | translate">
    <p-table [value]="person.sachverhalte" responsiveLayout="scroll">
      <ng-template pTemplate="caption">
        <p-button
          icon="pi pi-pencil"
          iconPos="left"
          [label]="'isyAngularWidgetsDemo.actions.addOrEditFact' | translate"
        >
        </p-button>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th scope="col">
            {{ 'isyAngularWidgetsDemo.labels.sachverhalte' | translate }}
          </th>
          <th scope="col">
            {{ 'isyAngularWidgetsDemo.labels.state' | translate }}
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-sachverhalt>
        <tr>
          <td>{{ sachverhalt }}</td>
          <td>
            {{ 'isyAngularWidgetsDemo.labels.solved' | translate }}
          </td>
        </tr>
      </ng-template>
    </p-table>
    <demo-dialog-sachverhalte-bearbeiten [person]="person"> </demo-dialog-sachverhalte-bearbeiten>
  </p-tabPanel>
</p-tabView>
<p-toast></p-toast>
