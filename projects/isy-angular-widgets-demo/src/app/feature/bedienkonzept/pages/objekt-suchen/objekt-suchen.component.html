<p-panel i18n-header header="Objekt suchen" [toggleable]="true" iconPos="start">
  <div class="p-fluid grid m-0">
    <div class="col-1 text-right align-self-center">
      <label class="" for="ID" i18n>ID</label>
    </div>
    <div class="col">
      <input id="ID" type="text" pInputText [(ngModel)]="person.id" class="ng-invalid ng-dirt"/>
    </div>
    <div class="col-1"></div>
    <div class="col"></div>
    <div class="col-1"></div>
    <div class="col"></div>
  </div>

  <div class="p-fluid grid m-0">
    <div class="col-1 text-right align-self-center">
      <label for="Nachname" i18n>Nachname</label>
    </div>
    <div class="col">
      <input id="Nachname" type="text" pInputText [(ngModel)]="person.personalien.nachname">
    </div>
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Geburtsname" i18n>Geburtsname</label>
    </div>
    <div class="col">
      <input id="Geburtsname" type="text" pInputText [(ngModel)]="person.personalien.geburtsname">
    </div>
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Geburtsname" i18n>Geburtsort</label>
    </div>
    <div class="col">
      <input id="Geburtsort" type="text" pInputText [(ngModel)]="person.personalien.geburtsort">
    </div>
  </div>

  <div class="p-fluid grid m-0">
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Vorname" i18n>Vorname</label>
    </div>
    <div class="col">
      <input id="Vorname" type="text" pInputText [(ngModel)]="person.personalien.vorname">
    </div>
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Geschlecht" i18n>Geschlecht</label>
    </div>
    <div class="col">
      <input id="Geschlecht" type="text" pInputText [(ngModel)]="person.personalien.geschlecht">
    </div>
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Geburtsdatum" i18n>Geburtsdatum</label>
    </div>
    <div class="col">
      <p-calendar id="Geburtsdatum"
                  dateFormat="dd.mm.yy"
                  [(ngModel)]="person.personalien.geburtsdatum"
                  [showIcon]="true"
      >
      </p-calendar>
    </div>
  </div>

  <div class="p-fluid grid m-0">
    <div class="col-1 text-right align-self-center">
      <label class="align-content-end" for="Staatsangehörigkeit" i18n>Staatsangehörigkeit</label>
    </div>
    <div class="col-7">
      <p-dropdown id="Staatsangehörigkeit" [options]="laender" [(ngModel)]="person.personalien.staatsangehoerigkeit"
                  [showClear]="true" i18n-placeholder placeholder="Land wählen">
        <ng-template pTemplate="selectedItem">
          <div class="country-item country-item-value" *ngIf="person.personalien.staatsangehoerigkeit">
            <div>{{person.personalien.staatsangehoerigkeit}}</div>
          </div>
        </ng-template>
        <ng-template let-land pTemplate="item">
          <div class="country-item">
            <div>{{land}}</div>
          </div>
        </ng-template>
      </p-dropdown>
    </div>
    <div class="col-1 text-right align-self-center"></div>
    <div class="col"></div>
    <div class="col-1 text-right align-self-center"></div>
    <div class="col"></div>
  </div>

  <div class="flex justify-content-end p-2">
    <p-button i18n-label label="Suchen"
              class="mr-1"
              [iconPos]="'left'"
              [icon]="'pi pi-search'"
              (onClick)="findPerson()"
    >
    </p-button>
    <p-button i18n-label label="Suche leeren"
              [iconPos]="'left'"
              [disabled]="!enableClearSearch()"
              (onClick)="clearSearch()"
    >
    </p-button>
  </div>
</p-panel>

<demo-result-list *ngIf="personen$ | async as personen"
                  [personen]="personen"
                  [selectedObject]="selectedPerson"
                  (edit)="editSelectedPerson($event)"
                  (create)="openAddNewObjectDialog()"
>
</demo-result-list>

<p-dialog i18n-header header="Ausgewähltes Objekt bearbeiten"
          [(visible)]="openEditForm"
          [modal]="modal"
          [style]="{
            width: width + 'vw'
          }"
>
  <div [formGroup]="editForm" *ngIf="selectedPerson && editForm">
    <div class="p-fluid grid m-0">
      <div class="col-1 text-right align-self-center">
        <label for="editID" i18n>ID</label>
      </div>
      <div class="col">
        <input id="editID" type="text" pInputText [formControlName]="'editID'"/>
      </div>
      <div class="col-1"></div>
      <div class="col"></div>
      <div class="col-1"></div>
      <div class="col"></div>
    </div>
    <div class="p-fluid grid m-0">
      <div class="col-1 text-right align-self-center">
        <label for="editNachname" i18n>Nachname</label>
      </div>
      <div class="col">
        <input id="editNachname" type="text" pInputText [formControlName]="'editNachname'">
      </div>
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editGeburtsname" i18n>Geburtsname</label>
      </div>
      <div class="col">
        <input id="editGeburtsname" type="text" pInputText [formControlName]="'editGeburtsname'">
      </div>
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editGeburtsname" i18n>Geburtsort</label>
      </div>
      <div class="col">
        <input id="editGeburtsort" type="text" pInputText [formControlName]="'editGeburtsort'">
      </div>
    </div>
    <div class="p-fluid grid m-0">
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editVorname" i18n>Vorname</label>
      </div>
      <div class="col">
        <input id="editVorname" type="text" pInputText [formControlName]="'editVorname'">
      </div>
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editGeschlecht" i18n>Geschlecht</label>
      </div>
      <div class="col">
        <input id="editGeschlecht" type="text" pInputText [formControlName]="'editGeschlecht'">
      </div>
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editGeburtsdatum" i18n>Geburtsdatum</label>
      </div>
      <div class="col">
        <p-calendar
          id="editGeburtsdatum"
          dateFormat="dd.mm.yy"
          [formControlName]="'editGeburtsdatum'"
          [showIcon]="true"
        >
        </p-calendar>
      </div>
    </div>
    <div class="p-fluid grid m-0">
      <div class="col-1 text-right align-self-center">
        <label class="align-content-end" for="editStaatsangehörigkeit" i18n>Staatsangehörigkeit</label>
      </div>
      <div class="col-7">
        <p-dropdown id="editStaatsangehörigkeit"
                    i18n-placeholder
                    placeholder="Land wählen"
                    [options]="laender"
                    [showClear]="true"
                    [formControlName]="'editStaatsangehoerigkeit'"
        >
          <ng-template pTemplate="selectedItem">
            <div class="country-item country-item-value" *ngIf="selectedPerson!.personalien.staatsangehoerigkeit">
              <div>{{selectedPerson!.personalien.staatsangehoerigkeit}}</div>
            </div>
          </ng-template>
          <ng-template let-land pTemplate="item">
            <div class="country-item">
              <div>{{land}}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
    </div>
    <div class="flex justify-content-end flex-wrap card-container pt-2">
      <p-button class="flex align-items-center justify-content-center mr-1"
                i18n-label
                label="Speichern"
                (onClick)="saveChanges()"
                [disabled]="!editForm.valid || !allowSave"
      >
      </p-button>
      <p-button class="flex align-items-center justify-content-center mr-1"
                i18n-label
                label="Schließen"
                (onClick)="displayEditDialog()"
      >
      </p-button>
    </div>
  </div>
</p-dialog>

<!--[headerTitle]="'Anlegen eines komplexen Objektes'"-->

<isy-wizard *ngIf="openWizard"
            [width]="50"
            [height]="30"
            i18n-headerTitle
            headerTitle = "Anlegen eines komplexen Objektes"
            [allowNext]="isFormValid"
            [(isVisible)]="openWizard"
            (isVisibleChange)="onWizardClose($event)"
            (stepperIndexChange)="getWizardIndex($event)"
            (savingChange)="getSavedStatus($event)"
            [isSaved]="savedSuccessfully"
            [closable]="displayX"
>
  <!-- The wizard is generic, you can input any element. For example:-->
  <!-- 1. A simple form -->
  <div *isyWizardDirective="idEintrag">
    <div [formGroup]="idForm">
      <div class="p-fluid formgrid grid">
        <div class="col align-content-end">
          <div class="col">
            <div class="field">
              <label id="idLabel" for="personId" i18n>ID*</label>
              <input id="personId" type="text" pInputText [formControlName]="'id'"/>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 2. A custom component representing your form -->
  <form *isyWizardDirective="persoenlicheInformationen">
    <demo-persoenliche-informationen [form]="persoenlicheInformationenForm">
    </demo-persoenliche-informationen>
  </form>

  <!-- 3. A complex form -->
  <div *isyWizardDirective="geburtsInformationen">
    <div class="p-fluid formgrid grid">
      <div class="col align-content-end">
        <div [formGroup]="geburtsInformationenForm">
          <div class="col">
            <div class="field">
              <label id="geburtsnameLabel" class="align-content-end" for="geburtname" i18n>Geburtsname*</label>
              <input id="geburtname" type="text" pInputText [formControlName]="'geburtsname'">
            </div>
            <div class="field">
              <label id="geburtsortLabel" class="align-content-end" for="geburtort" i18n>Geburtsort*</label>
              <input id="geburtort" type="text" pInputText [formControlName]="'geburtsort'">
            </div>
          </div>

          <div class="col">
            <div class="field">
              <label id="staatsangehoerigkeitLabel" class="align-content-end" for="staatangehoerigkeit" i18n>Staatsangehörigkeit*</label>
              <p-dropdown id="staatangehoerigkeit"
                          i18n-placeholder
                          placeholder="Land wählen"
                          optionValue="name"
                          optionLabel="name"
                          [showClear]="true"
                          [options]="laenderMap"
                          [formControlName]="'staatsangehoerigkeit'"
              >
                <ng-template let-land pTemplate="item">
                  <div class="country-item">
                    <div>{{land.name}}</div>
                  </div>
                </ng-template>
              </p-dropdown>
            </div>

            <div class="field">
              <label id="geburtsdatumLabel" class="align-content-end" for="geburtdatum" i18n>Geburtsdatum*</label>
              <p-calendar id="geburtdatum" dateFormat="dd.mm.yy" [formControlName]="'geburtsdatum'" [showIcon]="true">
              </p-calendar>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</isy-wizard>

<p-toast
  id="notificationToast"
  position="top-right"
>
</p-toast>
