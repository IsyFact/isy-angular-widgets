<p-panel
  iconPos="start"
  [header]="'isyAngularWidgetsDemo.displayObject.masterDataHeader' | translate"
  [toggleable]="true"
>
  <div class="grid mt-3">
    <div class="col-12 md:col-6 xl:col-4">
      <div class="field">
        <span class="p-float-label">
          <input
            id="basis-nachname"
            class="w-full"
            type="text"
            pInputText
            disabled
            [(ngModel)]="person.personalien.nachname"
          />
          <label for="basis-nachname">
            {{ 'isyAngularWidgetsDemo.labels.nachname' | translate }}
          </label>
        </span>
      </div>
    </div>
    <div class="col-12 md:col-6 xl:col-4">
      <div class="field">
        <span class="p-float-label">
          <input
            id="basis-vorname"
            class="w-full"
            type="text"
            pInputText
            disabled
            [(ngModel)]="person.personalien.vorname"
          />
          <label for="basis-vorname">
            {{ 'isyAngularWidgetsDemo.labels.vorname' | translate }}
          </label>
        </span>
      </div>
    </div>
    <div class="col-12 md:col-6 xl:col-4">
      <div class="field">
        <span class="p-float-label">
          <input
            id="basis-geburtsdatum"
            class="w-full"
            type="text"
            pInputText
            disabled
            [(ngModel)]="person.personalien.geburtsdatum"
          />
          <label for="basis-geburtsdatum">
            {{ 'isyAngularWidgetsDemo.labels.geburtsdatum' | translate }}
          </label>
        </span>
      </div>
    </div>
  </div>
</p-panel>

<p-tabView id="tab-view">
  <p-tabPanel id="panel-personalien" [header]="'isyAngularWidgetsDemo.displayObject.tabPersonalData' | translate">
    <form [formGroup]="personalInfoForm">
      <div class="grid mt-3">
        <div class="col-12 md:col-6 xl:col-4">
          <!-- Form-Wrapper-Komponente, die ein Label, welches automatisch zum Eingabefeld zugeordnet wird,
          ein beliebiges PrimeNG Eingabefeld und eine Validierungsnachricht beinhaltet. -->
          <isy-form-wrapper
            label="{{ 'isyAngularWidgetsDemo.labels.vorname' | translate }}"
            fieldId="first-name"
            [control]="personalInfoForm.controls.firstName | formControl"
            [validationMessages]="{required: 'isyAngularWidgetsDemo.messages.requiredMessage' | translate}"
          >
            <input
              id="first-name"
              formControlName="firstName"
              class="w-full"
              required
              minlength="2"
              type="text"
              pInputText
            />
          </isy-form-wrapper>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <span class="p-float-label">
              <input id="last-name" formControlName="lastName" type="text" pInputText isyInputChar />
              <label for="last-name">
                {{ 'isyAngularWidgetsDemo.labels.nachname' | translate }}
              </label>
            </span>
            <small
              class="p-error block"
              *ngIf="personalInfoForm.controls['lastName'].invalid && personalInfoForm.controls['lastName'].touched"
            >
              {{ 'isyAngularWidgetsDemo.messages.requiredMessage' | translate }}
            </small>
          </div>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <span class="p-float-label">
              <input id="birth-name" formControlName="birthName" type="text" pInputText isyInputChar />
              <label for="birth-name">
                {{ 'isyAngularWidgetsDemo.labels.geburtsname' | translate }}
              </label>
            </span>
          </div>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <span class="p-float-label">
              <input id="birth-place" formControlName="birthplace" class="w-full" type="text" pInputText />
              <label for="birth-place">
                {{ 'isyAngularWidgetsDemo.labels.geburtsort' | translate }}
              </label>
            </span>
          </div>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <span class="p-float-label">
              <p-dropdown
                inputId="gender"
                formControlName="gender"
                [filter]="true"
                filterBy="name"
                [options]="[
                  'isyAngularWidgetsDemo.labels.optionMale' | translate,
                  'isyAngularWidgetsDemo.labels.optionFemale' | translate,
                  'isyAngularWidgetsDemo.labels.optionDivers' | translate
                ]"
                styleClass="w-full"
                appendTo="body"
              ></p-dropdown>
              <label for="gender">
                {{ 'isyAngularWidgetsDemo.labels.geschlecht' | translate }}
              </label>
            </span>
          </div>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <!-- Form-Wrapper-Komponente, die ein Label, welches automatisch zum Eingabefeld zugeordnet wird, 
          ein beliebiges PrimeNG Eingabefeld und eine Validierungsnachricht beinhaltet.
          Die Formcontrol nutzt einen benutzerdefinierten Validator. -->
          <isy-form-wrapper
            label="{{ 'isyAngularWidgetsDemo.labels.geburtsdatum' | translate }}"
            fieldId="birth-date"
            [control]="personalInfoForm.controls.birthDate | formControl"
            [validationMessages]="{PAST: 'isyAngularWidgetsDemo.messages.dateInPastError' | translate}"
          >
            <p-calendar
              inputId="birth-date"
              dateFormat="dd.mm.yy"
              formControlName="birthDate"
              [showIcon]="true"
              styleClass="w-full"
              appendTo="body"
            >
            </p-calendar>
          </isy-form-wrapper>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <span class="p-float-label">
              <input id="nationality" formControlName="nationality" class="w-full" type="text" pInputText />
              <label for="nationality">
                {{ 'isyAngularWidgetsDemo.labels.staatsangehoerigkeit' | translate }}
              </label>
            </span>
          </div>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <span class="p-float-label">
              <p-inputMask
                inputId="phone-number"
                formControlName="phoneNumber"
                type="text"
                styleClass="w-full"
                mask="+99 9999 / 9999999"
              >
              </p-inputMask>
              <label for="phone-number">
                {{ 'isyAngularWidgetsDemo.labels.telefonnummer' | translate }}
              </label>
            </span>
          </div>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <span class="p-float-label">
              <isy-incomplete-date
                inputId="date-of-entry"
                formControlName="dateOfEntry"
                [dateInPastConstraint]="true"
                inputLabel="{{ 'isyAngularWidgetsDemo.labels.einreisedatum' | translate }}"
              >
              </isy-incomplete-date>
              <label for="date-of-entry">
                {{ 'isyAngularWidgetsDemo.labels.einreisedatum' | translate }}
              </label>
            </span>
            <small
              class="p-error block"
              *ngIf="
                personalInfoForm.controls['dateOfEntry'].invalid &&
                (personalInfoForm.controls['dateOfEntry'].touched || personalInfoForm.controls['dateOfEntry'].dirty)
              "
            >
              {{ 'isyAngularWidgetsDemo.messages.inputUnspecifiedError' | translate }}
            </small>
          </div>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <span class="p-float-label">
              <input id="date-of-departure" formControlName="dateOfDeparture" class="w-full" type="text" pInputText />
              <label for="date-of-departure">
                {{ 'isyAngularWidgetsDemo.labels.abreisedatum' | translate }}
              </label>
            </span>
          </div>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <span class="p-float-label">
              <p-calendar
                inputId="passport-expiration-date"
                dateFormat="dd.mm.yy"
                formControlName="passportExpirationDate"
                [showIcon]="true"
                styleClass="w-full"
                appendTo="body"
              ></p-calendar>
              <label for="passport-expiration-date">
                {{ 'isyAngularWidgetsDemo.labels.ablaufdatumReisepass' | translate }}
              </label>
            </span>
          </div>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <span class="p-float-label">
              <input id="credit-card-number" formControlName="creditCardNumber" class="w-full" type="text" pInputText />
              <label for="credit-card-number">
                {{ 'isyAngularWidgetsDemo.labels.kreditkartennummer' | translate }}
              </label>
            </span>
          </div>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <span class="p-float-label">
              <input
                id="credit-card-expiration-date"
                formControlName="creditCardExpirationDate"
                class="w-full"
                type="text"
                pInputText
              />
              <label for="credit-card-expiration-date">
                {{ 'isyAngularWidgetsDemo.labels.ablaufdatumKreditkarte' | translate }}
              </label>
            </span>
          </div>
        </div>
        <div class="col-12 md:col-6 xl:col-4">
          <div class="field">
            <p-fileUpload
              id="identity-document"
              formControlName="identityDocument"
              ngDefaultControl
              [name]="'myfile'"
              [accept]="'image/*,.pdf,.txt'"
              [auto]="true"
              [maxFileSize]="1000000"
              [customUpload]="true"
              (uploadHandler)="uploadFile($event)"
              chooseLabel="{{ 'isyAngularWidgetsDemo.labels.identityDocument' | translate }}"
            >
            </p-fileUpload>
          </div>
        </div>
      </div>

      <div class="field field-checkbox my-5">
        <p-inputSwitch inputId="show-secret-fields" (onChange)="showSecretFields = $event.checked"></p-inputSwitch>
        <label for="show-secret-fields" class="m-0 ml-3">
          {{ 'isyAngularWidgetsDemo.actions.showSecretFields' | translate }}
        </label>
      </div>

      <div id="div-show-secret-fields" *ngIf="showSecretFields">
        <div class="grid m-0 align-items-center">
          <div class="col-12 md:col-6 xl:col-4">
            <div class="field field-checkbox">
              <p-checkbox id="id-required" formControlName="idRequired" [binary]="true"> </p-checkbox>
              <label for="id-required" class="m-0 ml-3">
                {{ 'isyAngularWidgetsDemo.labels.ausweispflichtig' | translate }}
              </label>
            </div>
          </div>
          <div class="col-12 md:col-6 xl:col-4">
            <div class="field">
              <span class="p-float-label">
                <p-inputNumber
                  id="security-level"
                  formControlName="securityLevel"
                  [showButtons]="true"
                  [min]="0"
                  [max]="9"
                  class="w-full"
                  styleClass="w-full"
                  inputStyleClass="w-full"
                >
                </p-inputNumber>
                <label for="security-level">
                  {{ 'isyAngularWidgetsDemo.labels.sicherheitsstufe' | translate }}
                </label>
              </span>
            </div>
          </div>
          <div class="col-12 xl:col-8">
            <div class="field">
              <span class="p-float-label">
                <textarea
                  pInputTextarea
                  id="intelligence-notes"
                  formControlName="intelligenceNotes"
                  class="w-full"
                  [rows]="5"
                >
                </textarea>
                <label for="intelligence-notes">
                  {{ 'isyAngularWidgetsDemo.labels.geheimdienstnotizen' | translate }}
                </label>
              </span>
              <small class="p-error block" *ngIf="personalInfoForm.controls['intelligenceNotes'].invalid">
                {{
                  'isyAngularWidgetsDemo.messages.maxLengthError' | translate: {numChars: intelligenceNotesMaxLength}
                }}
              </small>
            </div>
          </div>
        </div>
      </div>
    </form>

    <div class="justify-content-center flex mt-3">
      <button
        pButton
        *ngIf="personalInfoForm.disabled"
        id="button-edit"
        icon="pi pi-user-edit"
        iconPos="left"
        [label]="'isyAngularWidgetsDemo.actions.edit' | translate"
        (click)="personalInfoForm.enable()"
      ></button>
      <div id="div-save-cancel" *ngIf="!personalInfoForm.disabled" class="p-buttonset">
        <button
          pButton
          id="button-save"
          icon="pi pi-save"
          iconPos="left"
          [disabled]="!personalInfoForm.valid"
          [label]="'isyAngularWidgetsDemo.actions.save' | translate"
          (click)="savePersonalien()"
        ></button>
        <button
          pButton
          id="button-cancel"
          icon="pi pi-times"
          class="p-button-outlined"
          iconPos="left"
          [label]="'isyAngularWidgetsDemo.actions.cancel' | translate"
          (click)="this.personalInfoForm.disable()"
        ></button>
      </div>
    </div>
  </p-tabPanel>

  <p-tabPanel id="panel-sachverhalte" [header]="'isyAngularWidgetsDemo.displayObject.tabFacts' | translate">
    <p-table [value]="person.sachverhalte" responsiveLayout="scroll">
      <ng-template pTemplate="caption">
        <p-button
          icon="pi pi-pencil"
          iconPos="left"
          [label]="'isyAngularWidgetsDemo.actions.addOrEditFact' | translate"
        >
        </p-button>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th scope="col">
            {{ 'isyAngularWidgetsDemo.labels.sachverhalte' | translate }}
          </th>
          <th scope="col">
            {{ 'isyAngularWidgetsDemo.labels.state' | translate }}
          </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-sachverhalt>
        <tr>
          <td>{{ sachverhalt }}</td>
          <td>
            {{ 'isyAngularWidgetsDemo.labels.solved' | translate }}
          </td>
        </tr>
      </ng-template>
    </p-table>
    <demo-dialog-sachverhalte-bearbeiten [person]="person"> </demo-dialog-sachverhalte-bearbeiten>
  </p-tabPanel>
</p-tabView>
<p-toast></p-toast>
